<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>web_plsql Admin Console</title>
		<link rel="icon" type="image/svg+xml" href="favicon.svg" />
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
		<link rel="stylesheet" href="style.css" />
	</head>
	<body class="dark">
		<div class="app-container">
			<aside class="sidebar">
				<div class="logo">
					<span class="material-symbols-rounded">database</span>
					<div style="display: flex; flex-direction: column; line-height: 1">
						<span>web_plsql</span>
						<small id="sidebar-version" style="font-size: 0.65rem; opacity: 0.7; margin-top: 2px"></small>
					</div>
				</div>
				<nav>
					<button data-view="overview" class="active">
						<span class="material-symbols-rounded">dashboard</span>
						Overview
					</button>
					<button data-view="errors">
						<span class="material-symbols-rounded">error</span>
						Errors
					</button>
					<button data-view="access">
						<span class="material-symbols-rounded">list_alt</span>
						Access Log
					</button>
					<button data-view="pools">
						<span class="material-symbols-rounded">database</span>
						Pools
					</button>
					<button data-view="config">
						<span class="material-symbols-rounded">settings</span>
						Configuration
					</button>
					<button data-view="system">
						<span class="material-symbols-rounded">terminal</span>
						System
					</button>
				</nav>
				<div class="status-indicator">
					<span id="server-status-dot" class="dot"></span>
					<span id="server-status-text">Checking...</span>
				</div>
			</aside>
			<main class="content">
				<header class="main-header">
					<h1 id="view-title"><span class="material-symbols-rounded">dashboard</span>Overview</h1>
					<div class="header-toolbar">
						<div class="auto-refresh-group">
							<label for="auto-refresh-toggle">Auto-refresh</label>
							<input type="checkbox" id="auto-refresh-toggle" checked />
							<select id="refresh-interval">
								<option value="5000">5s</option>
								<option value="10000">10s</option>
								<option value="30000" selected>30s</option>
								<option value="60000">60s</option>
							</select>
							<button
								id="manual-refresh"
								class="icon-btn icon-sm"
								title="Refresh Now"
								style="border: none; background: none; padding: 0; min-width: auto; min-height: auto; margin-left: 4px"
							>
								<span class="material-symbols-rounded" style="font-size: 20px">refresh</span>
							</button>
						</div>
						<button id="theme-toggle-btn" class="icon-btn" title="Toggle Theme">
							<span class="material-symbols-rounded">dark_mode</span>
						</button>
					</div>
				</header>

				<section id="view-overview" class="view">
					<div class="metrics-grid">
						<div class="card">
							<div class="card-header">
								<span class="material-symbols-rounded">schedule</span>
								<h3>Uptime</h3>
							</div>
							<p id="uptime-val">0s</p>
							<small id="start-time-val">-</small>
						</div>
						<div class="card">
							<div class="card-header">
								<span class="material-symbols-rounded">swap_vert</span>
								<h3>Requests</h3>
							</div>
							<p id="req-count">0</p>
							<div style="display: flex; gap: 8px">
								<small id="req-per-sec">0 req/s</small>
								<small id="avg-resp-time">Avg: 0ms</small>
							</div>
						</div>
						<div class="card">
							<div class="card-header">
								<span class="material-symbols-rounded">report</span>
								<h3>Errors</h3>
							</div>
							<p id="err-count">0</p>
						</div>
						<div class="card">
							<div class="card-header">
								<span class="material-symbols-rounded">cached</span>
								<h3>Cache Hit Rate</h3>
							</div>
							<p id="cache-hit-rate-val">0%</p>
							<small><span id="cache-hits-val">0</span> hits, <span id="cache-misses-val">0</span> misses</small>
						</div>
					</div>

					<div class="card" style="grid-column: span 2">
						<div class="card-header">
							<span class="material-symbols-rounded">monitoring</span>
							<h3>Traffic & Errors</h3>
							<div class="header-toolbar ml-auto">
								<select
									id="chart-history-points"
									class="btn-sm"
									style="
										background: var(--bg-hover);
										border: 1px solid var(--border);
										border-radius: 4px;
										color: var(--text-main);
										font-size: 0.75rem;
										padding: 2px 4px;
									"
								>
									<option value="30">Last 30 pts</option>
									<option value="60">Last 60 pts</option>
									<option value="120">Last 120 pts</option>
								</select>
							</div>
						</div>
						<div class="chart-container">
							<canvas id="traffic-chart"></canvas>
						</div>
					</div>
				</section>

				<section id="view-pools" class="view" style="display: none">
					<div id="pools-container" class="pools-grid"></div>
					<div class="card">
						<div class="card-header">
							<span class="material-symbols-rounded">analytics</span>
							<h3>Pool Usage History</h3>
						</div>
						<div class="chart-container">
							<canvas id="pool-chart"></canvas>
						</div>
					</div>
				</section>

				<section id="view-errors" class="view" style="display: none">
					<div class="table-container">
						<table id="errors-table">
							<thead>
								<tr>
									<th>Timestamp</th>
									<th>Method</th>
									<th>URL</th>
									<th>Message</th>
								</tr>
							</thead>
							<tbody></tbody>
						</table>
					</div>
				</section>

				<section id="view-access" class="view" style="display: none">
					<div class="terminal-container">
						<pre id="access-log-view" class="terminal"></pre>
					</div>
				</section>

				<section id="view-config" class="view" style="display: none">
					<div id="config-view"></div>
				</section>

				<section id="view-system" class="view" style="display: none">
					<div class="metrics-grid mb-6">
						<div class="card">
							<div class="card-header">
								<span class="material-symbols-rounded">info</span>
								<h3>Server Information</h3>
							</div>
							<div class="text-sm text-main">
								<div class="stat-row">
									<span>Middleware Version</span>
									<span id="middleware-version" class="font-mono text-accent font-bold">-</span>
								</div>
								<div class="stat-row">
									<span>Node.js Version</span>
									<span id="node-version" class="font-mono text-accent font-bold">-</span>
								</div>
								<div class="stat-row">
									<span>Platform</span>
									<span id="platform-info" class="text-accent font-bold">-</span>
								</div>
							</div>
						</div>
						<div class="card">
							<div class="card-header">
								<span class="material-symbols-rounded">schedule</span>
								<h3>Runtime</h3>
							</div>
							<div class="text-sm text-main">
								<div class="stat-row">
									<span>Server Uptime</span>
									<span id="system-uptime" class="text-accent font-bold">-</span>
								</div>
								<div class="stat-row">
									<span>Start Time</span>
									<span id="system-start-time" class="text-accent font-bold">-</span>
								</div>
								<div class="stat-row">
									<span>Status</span>
									<span id="system-status" class="status-dot">
										<span class="dot running"></span>
										<span id="system-status-text" class="text-accent font-bold">-</span>
									</span>
								</div>
								<div class="stat-row">
									<span>Auto-refresh</span>
									<span id="system-refresh-status" class="text-accent font-bold">Active (30s)</span>
								</div>
							</div>
						</div>
						<div class="card">
							<div class="card-header">
								<span class="material-symbols-rounded">insights</span>
								<h3>Activity</h3>
							</div>
							<div class="text-sm text-main">
								<div class="stat-row">
									<span>Total Requests</span>
									<span id="total-requests" class="font-mono text-accent font-bold">-</span>
								</div>
								<div class="stat-row">
									<span>Total Errors</span>
									<span id="total-errors" class="font-mono text-danger font-bold">-</span>
								</div>
								<div class="stat-row">
									<span>Active Pools</span>
									<span id="active-pools" class="font-mono text-accent font-bold">-</span>
								</div>
							</div>
						</div>
					</div>

					<div class="metrics-grid mb-6">
						<div class="card">
							<div class="card-header">
								<span class="material-symbols-rounded">memory</span>
								<h3>Memory Usage</h3>
							</div>
							<div class="text-sm text-main">
								<div class="stat-row">
									<span>Heap Used</span>
									<span id="memory-heap-used" class="font-mono text-accent font-bold">-</span>
								</div>
								<div class="stat-row">
									<span>Heap Total</span>
									<span id="memory-heap-total" class="font-mono text-accent font-bold">-</span>
								</div>
								<div class="stat-row">
									<span>RSS</span>
									<span id="memory-rss" class="font-mono text-accent font-bold">-</span>
								</div>
								<div class="stat-row">
									<span>External</span>
									<span id="memory-external" class="font-mono text-accent font-bold">-</span>
								</div>
							</div>
						</div>
						<div class="card">
							<div class="card-header">
								<span class="material-symbols-rounded">speed</span>
								<h3>CPU Usage</h3>
							</div>
							<div class="text-sm text-main">
								<div class="stat-row">
									<span>User</span>
									<span id="cpu-user" class="font-mono text-accent font-bold">-</span>
								</div>
								<div class="stat-row">
									<span>System</span>
									<span id="cpu-system" class="font-mono text-accent font-bold">-</span>
								</div>
							</div>
						</div>
					</div>

					<div class="card danger-zone">
						<h3 class="danger-zone-title">Danger Zone</h3>
						<p class="danger-zone-text">Careful! These actions affect the production server state.</p>
						<div style="display: flex; gap: 12px; margin-top: 16px">
							<button id="btn-clear-all-cache" class="btn btn-sm btn-warning">Clear All Caches</button>
							<button id="btn-pause" class="btn btn-sm btn-warning">Pause Server</button>
							<button id="btn-resume" class="btn btn-sm btn-success" style="display: none">Resume Server</button>
							<button id="btn-stop" class="btn btn-sm btn-danger">Stop Server</button>
						</div>
					</div>
				</section>
			</main>
		</div>
		<script type="module" src="lib/chart.bundle.js"></script>
	</body>
</html>
